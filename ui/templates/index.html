<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>North Star — High-Conflict Case Analysis</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-brand">
                <div class="nav-icon">
                    <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
                    </svg>
                </div>
                <span class="nav-title">North Star</span>
            </div>
            <span class="nav-subtitle">High-Conflict Case Analysis</span>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1 class="hero-title">
                You know something is wrong.<br>
                <span class="hero-title-muted">You just don't know what to call it.</span>
            </h1>
            <p class="hero-description">
                You feel it. You've documented what you could. But when your attorney asks for 
                <strong>10 clear examples</strong> — you don't even know 
                if what you're seeing has a name.
            </p>
        </div>
    </section>

    <!-- Stats Section -->
    <section class="stats-section">
        <div class="stats-content">
            <div class="stats-header">
                <p class="stats-label">The Scale of the Problem</p>
                <h2 class="stats-title">These are children. Caught in the middle. And no one is translating for them.</h2>
            </div>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number">22M</div>
                    <div class="stat-label">Children with a parent<br>outside the home</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">20%</div>
                    <div class="stat-label">Of divorces are<br>high-conflict</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">80%</div>
                    <div class="stat-label">Of court time consumed<br>by that 20%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">50%</div>
                    <div class="stat-label">Higher anxiety/depression<br>in children affected</div>
                </div>
            </div>
            <div class="stats-footer">
                <p>
                    Children in high-conflict cases are <strong>3× more likely</strong> to go through repeated custody battles. 
                    Their cases take <strong>40% longer</strong> to resolve. 
                    Meanwhile, parents who SEE what's happening have no vocabulary to explain it — and no one to help them translate.
                </p>
            </div>
        </div>
    </section>

    <!-- The Gap Section -->
    <section class="gap-section">
        <div class="gap-card">
            <div class="gap-grid">
                <!-- What You Have -->
                <div class="gap-column">
                    <div class="gap-header">What You're Living</div>
                    <ul class="gap-list gap-list-dashes">
                        <li><span class="gap-dash">—</span><span>A mountain of notes, but no idea which ones matter</span></li>
                        <li><span class="gap-dash">—</span><span>A gut feeling you can't put into words</span></li>
                        <li><span class="gap-dash">—</span><span>Fear of picking the wrong examples and not being taken seriously</span></li>
                        <li><span class="gap-dash">—</span><span>No vocabulary for what you're seeing</span></li>
                    </ul>
                </div>
                
                <!-- What They Need -->
                <div class="gap-column">
                    <div class="gap-header">What Professionals Need</div>
                    <ul class="gap-list gap-list-checks">
                        <li><span class="gap-check">✓</span><span>Patterns with names they already recognize</span></li>
                        <li><span class="gap-check">✓</span><span>Concrete examples with dates and sources</span></li>
                        <li><span class="gap-check">✓</span><span>Clear documentation of impact on the child</span></li>
                        <li><span class="gap-check">✓</span><span>Language appropriate to their professional role</span></li>
                    </ul>
                </div>
            </div>
            
            <!-- Bridge Statement -->
            <div class="gap-bridge">
                <p>
                    <strong>North Star is the translator.</strong> It takes what you're living and maps it to 
                    patterns courts and evaluators already recognize — so you can finally explain what you're 
                    seeing in words they'll take seriously.
                </p>
            </div>
        </div>
    </section>

    <!-- Three Outputs Section -->
    <section class="outputs-section">
        <div class="outputs-content">
            <div class="outputs-header">
                <h2>Three Summaries. Three Audiences. Three Languages.</h2>
                <p>
                    Each professional needs to see your documentation differently. 
                    What works for your attorney could hurt you with your child's therapist. 
                    North Star translates once — into all three.
                </p>
            </div>
            
            <div class="output-cards">
                <!-- Attorney -->
                <div class="output-card">
                    <div class="output-card-content">
                        <div class="output-icon">
                            <svg width="28" height="28" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                            </svg>
                        </div>
                        <div class="output-text">
                            <h3>Attorney Summary</h3>
                            <p>
                                Your attorney needs <strong>facts</strong> — not feelings. They need dates, sources, and 
                                observable events. Your emotional interpretation? That actually hurts your case. 
                                This summary strips emotion, removes personal conclusions, and presents only what 
                                can be verified. Neutral language. No accusations. Just evidence.
                            </p>
                            <div class="output-tags">
                                <span class="tag">Facts only</span>
                                <span class="tag">Dated & sourced</span>
                                <span class="tag">Emotion stripped</span>
                                <span class="tag">Court-ready</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- GAL & Therapist -->
                <div class="output-card">
                    <div class="output-card-content">
                        <div class="output-icon">
                            <svg width="28" height="28" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 18.719m12 0a5.971 5.971 0 00-.941-3.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-5.058 2.772m0 0a3 3 0 00-4.681 2.72 8.986 8.986 0 003.74.477m.94-3.197a5.971 5.971 0 00-.94 3.197M15 6.75a3 3 0 11-6 0 3 3 0 016 0zm6 3a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-13.5 0a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z" />
                            </svg>
                        </div>
                        <div class="output-text">
                            <h3>Guardian Ad Litem & Therapist Summary</h3>
                            <p>
                                The Guardian Ad Litem and your child's therapist need to understand <strong>impact on 
                                the child</strong>. Not just what happened — but how it affected your child's behavior, 
                                emotional state, and development. This summary focuses on observable behavioral changes, 
                                child statements, and developmental context. It's still factual — but framed through 
                                the lens of child wellbeing.
                            </p>
                            <div class="output-tags">
                                <span class="tag">Child-impact focused</span>
                                <span class="tag">Behavioral observations</span>
                                <span class="tag">Developmental context</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Internal Clarity -->
                <div class="output-card">
                    <div class="output-card-content">
                        <div class="output-icon">
                            <svg width="28" height="28" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.383a14.406 14.406 0 01-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 10-7.517 0c.85.493 1.509 1.333 1.509 2.316V18" />
                            </svg>
                        </div>
                        <div class="output-text">
                            <h3>Internal Clarity</h3>
                            <p>
                                This one's for <strong>you</strong>. It shows you which patterns were identified, 
                                which incidents supported them, and — critically — what was <em>not</em> included 
                                and why. Maybe something didn't meet the threshold. Maybe an incident was adult 
                                conflict, not child impact. This is your reference to understand what the tool 
                                saw and why it made the choices it made.
                            </p>
                            <div class="output-tags">
                                <span class="tag">Pattern rationale</span>
                                <span class="tag">What wasn't included</span>
                                <span class="tag">Your reference</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Research Foundation with Patterns -->
    <section class="patterns-section">
        <div class="patterns-content">
            <div class="patterns-card">
                <div class="patterns-header">
                    <div class="patterns-intro">
                        <h2>These Patterns Already Exist. You Just Didn't Know Their Names.</h2>
                        <p>
                            North Star maps your documentation to <strong>10 behavioral patterns</strong> identified 
                            in high-conflict custody research. These aren't invented categories — they're patterns 
                            evaluators, guardians ad litem, and family courts already recognize and look for.
                        </p>
                        <p class="patterns-tagline">The vocabulary exists. Now you have access to it.</p>
                    </div>
                    <div class="patterns-count">
                        <div class="patterns-number">10</div>
                        <div class="patterns-count-label">Research-Backed<br>Patterns</div>
                    </div>
                </div>
                
                <div class="patterns-list">
                    <p class="patterns-list-intro">You might recognize what you've been living:</p>
                    <div class="patterns-grid">
                        <div class="pattern-item">
                            <span class="pattern-bullet">•</span>
                            <span><strong>Medical/Therapeutic Interference</strong> <span class="pattern-quote">— "He forgot her medication again."</span></span>
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-bullet">•</span>
                            <span><strong>Boundary Violations</strong> <span class="pattern-quote">— "She knows how much child support I pay."</span></span>
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-bullet">•</span>
                            <span><strong>Coaching & Information Control</strong> <span class="pattern-quote">— "Don't tell Mommy about this, okay?"</span></span>
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-bullet">•</span>
                            <span><strong>Negative Parent Portrayal</strong> <span class="pattern-quote">— "Daddy says you don't love me anymore."</span></span>
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-bullet">•</span>
                            <span><strong>Triangulation & Loyalty Conflicts</strong> <span class="pattern-quote">— "Tell your mom she needs to sign this."</span></span>
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-bullet">•</span>
                            <span><strong>Parentification & Role Reversal</strong> <span class="pattern-quote">— "I have to make sure Dad is okay."</span></span>
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-bullet">•</span>
                            <span><strong>Distorted Narratives</strong> <span class="pattern-quote">— "Wait... that's not how I remember it."</span></span>
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-bullet">•</span>
                            <span><strong>Communication Breakdown</strong> <span class="pattern-quote">— "Mom, Dad wants to know if..."</span></span>
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-bullet">•</span>
                            <span><strong>Financial Impact on Child</strong> <span class="pattern-quote">— "I don't need new shoes, Mom. It's fine."</span></span>
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-bullet">•</span>
                            <span><strong>Schedule & Transition Disruption</strong> <span class="pattern-quote">— "My tummy hurts. I don't want to go."</span></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Why I Built This -->
    <section class="story-section">
        <div class="story-content">
            <div class="story-card">
                <div class="story-header">
                    <span>Why I Built This</span>
                </div>
                
                <div class="story-body">
                    <div class="story-text">
                        <p class="story-lead">My attorney asked for 10 clear examples. I had <em>hundreds</em> of notes.</p>
                        <p>And I froze.</p>
                        <p>
                            Not because I didn't have evidence — I was sitting on a mountain of it. 
                            But how the hell do I pick 10? How do I know which ones matter? 
                            What if I pick the wrong ones and he doesn't take this seriously?
                        </p>
                        <p>
                            I could <em>see</em> that something was wrong. My daughter and I were living it. 
                            Every transition, every phone call, every time she came home not quite herself. 
                            But I had no idea how to put it into words. I didn't know what the patterns were 
                            called. I didn't know what my attorney needed from me to take it seriously.
                        </p>
                        <p>
                            It was like trying to find a needle in a haystack — while also having to 
                            translate everything into a language I didn't speak.
                        </p>
                        <p class="story-highlight">That's why I built this.</p>
                        <p>
                            I needed someone to look at what I was living and say: <strong>this 
                            matters</strong>. I needed vocabulary. I needed to know that what I was seeing had a name — 
                            and that courts recognize these patterns every single day.
                        </p>
                        <p>
                            This tool gives you what I didn't have. The vocabulary. The patterns. The validation 
                            that what you're seeing is real — and it has a name.
                        </p>
                    </div>
                </div>
                
                <div class="story-footer">
                    <div class="story-solidarity">
                        <div class="solidarity-icon">
                            <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 18.719m12 0a5.971 5.971 0 00-.941-3.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-5.058 2.772m0 0a3 3 0 00-4.681 2.72 8.986 8.986 0 003.74.477m.94-3.197a5.971 5.971 0 00-.94 3.197M15 6.75a3 3 0 11-6 0 3 3 0 016 0zm6 3a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-13.5 0a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z" />
                            </svg>
                        </div>
                        <div>
                            <p class="solidarity-title">You're not in this alone.</p>
                            <p class="solidarity-text">
                                There are thousands of parents fighting the same fight — for their kids, against the chaos. 
                                This tool exists because I refused to let anyone else sit in that same silence, 
                                wondering if what they're living has a name. It does. And now you have access to it.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Trust & Safety -->
    <section class="trust-section">
        <div class="trust-content">
            <div class="trust-header">
                <h2>Built for Safety. Built for Trust.</h2>
                <p>We understand what's at stake.</p>
            </div>
            
            <div class="trust-grid">
                <div class="trust-card">
                    <div class="trust-card-content">
                        <div class="trust-icon trust-icon-amber">
                            <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z" />
                            </svg>
                        </div>
                        <div>
                            <h3>100% Local Processing</h3>
                            <p>
                                Your documents never leave your computer. No cloud storage. No servers. No data that could 
                                be subpoenaed, requested in discovery, or accessed by anyone else. Ever.
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="trust-card">
                    <div class="trust-card-content">
                        <div class="trust-icon trust-icon-blue">
                            <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z" />
                            </svg>
                        </div>
                        <div>
                            <h3>Maps, Not Invents</h3>
                            <p>
                                The AI maps your facts to predefined, research-backed patterns. It does not invent 
                                categories, make assumptions, or fill in gaps. If evidence isn't there, it says so.
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="trust-card">
                    <div class="trust-card-content">
                        <div class="trust-icon trust-icon-purple">
                            <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v17.25m0 0c-1.472 0-2.882.265-4.185.75M12 20.25c1.472 0 2.882.265 4.185.75M18.75 4.97A48.416 48.416 0 0012 4.5c-2.291 0-4.545.16-6.75.47m13.5 0c1.01.143 2.01.317 3 .52m-3-.52l2.62 10.726c.122.499-.106 1.028-.589 1.202a5.988 5.988 0 01-2.031.352 5.988 5.988 0 01-2.031-.352c-.483-.174-.711-.703-.59-1.202L18.75 4.971zm-16.5.52c.99-.203 1.99-.377 3-.52m0 0l2.62 10.726c.122.499-.106 1.028-.589 1.202a5.989 5.989 0 01-2.031.352 5.989 5.989 0 01-2.031-.352c-.483-.174-.711-.703-.59-1.202L5.25 4.971z" />
                            </svg>
                        </div>
                        <div>
                            <h3>Orientation, Not Authority</h3>
                            <p>
                                This tool helps you organize and translate. It does not provide legal advice, clinical 
                                diagnosis, or professional recommendations. Always work with your attorney and professionals.
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="trust-card">
                    <div class="trust-card-content">
                        <div class="trust-icon trust-icon-green">
                            <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" />
                            </svg>
                        </div>
                        <div>
                            <h3>Zero Fabrication</h3>
                            <p>
                                The system never generates, infers, or assumes content not in your documentation. 
                                Unclear information is marked as unclear. Gaps are flagged, never filled.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Divider -->
    <div class="divider"></div>

    <!-- Upload Section -->
    <section class="upload-section">
        <div class="upload-content">
            
            <!-- Prerequisite Notice -->
            <div class="prerequisite-notice">
                <div class="prerequisite-content">
                    <div class="prerequisite-icon">
                        <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z" />
                        </svg>
                    </div>
                    <div>
                        <h3>You Don't Need Perfect Documentation</h3>
                        <div class="prerequisite-text">
                            <p>
                                North Star doesn't require years of meticulous records. It works with what you have — 
                                scattered notes, saved texts, incidents you wrote down because something felt wrong.
                            </p>
                            <p>
                                <strong>What you need:</strong> Some form of documentation — 
                                notes, texts, logs, emails, anything you've captured. Even if it's messy. Even if you're 
                                not sure what it means.
                            </p>
                            <p>
                                <strong>What North Star does:</strong> Takes what you have and 
                                maps it to patterns that have names — so you finally have the vocabulary to explain 
                                what you've been seeing.
                            </p>
                            <p class="prerequisite-note">
                                If you haven't started documenting yet, start there first. This tool will be here when you're ready.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Error Message (hidden by default) -->
            <div id="error-message" class="error-message hidden">
                <span class="error-icon">!</span>
                <span class="error-text">Unable to process file. Please ensure it's a .txt or .md file under 10 pages.</span>
                <button class="error-close" onclick="hideError()">✕</button>
            </div>

            <!-- Upload Area -->
            <div id="upload-area">
                <div class="upload-header">
                    <h2>Ready to Begin</h2>
                    <p>Upload your documentation and find your North Star.</p>
                </div>
                
                <div class="upload-dropzone" id="dropzone">
                    <div class="dropzone-icon">
                        <svg width="28" height="28" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5" />
                        </svg>
                    </div>
                    <p class="dropzone-text">Drop your file here, or click to browse</p>
                    <input type="file" id="file-input" accept=".txt,.md" hidden>
                    <button class="btn-primary" onclick="document.getElementById('file-input').click()">
                        Select File
                    </button>
                    <p class="dropzone-hint">Accepts .txt or .md files (max 10 pages)</p>
                </div>

                <!-- File Selected (hidden by default) -->
                <div id="file-selected" class="file-selected hidden">
                    <div class="file-info">
                        <div class="file-icon">
                            <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                            </svg>
                        </div>
                        <div class="file-details">
                            <div class="file-name" id="selected-filename">document.md</div>
                            <div class="file-status">Ready to analyze</div>
                        </div>
                    </div>
                    <button class="file-remove" onclick="removeFile()">
                        <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                
                <!-- Analyze Button (hidden by default) -->
                <button id="analyze-btn" class="btn-analyze hidden" onclick="analyzeDocument()">
                    Analyze Documentation
                </button>
            </div>

            <!-- Processing (hidden by default) -->
            <div id="processing-area" class="processing-card hidden">
                <div class="spinner"></div>
                <h3>Analyzing Documentation</h3>
                <p>Mapping facts to research-backed patterns...</p>
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
            </div>

            <!-- Results (hidden by default) -->
            <div id="results-area" class="hidden">
                <!-- Success Message -->
                <div class="success-message">
                    <div class="success-icon">
                        <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                        </svg>
                    </div>
                    <span>Analysis complete. Your summaries are ready.</span>
                </div>

                <!-- Tabs -->
                <div class="results-card">
                    <div class="tabs">
                        <button class="tab active" data-tab="attorney" onclick="switchTab('attorney', this)">Attorney</button>
                        <button class="tab" data-tab="gal" onclick="switchTab('gal', this)">GAL & Therapist</button>
                        <button class="tab" data-tab="internal" onclick="switchTab('internal', this)">Internal Clarity</button>
                    </div>

                    <div class="tab-content">
                        <div class="tab-header">
                            <h3 id="tab-title">Attorney Summary</h3>
                            <a id="download-btn" class="btn-download" href="/download/attorney-summary.md" download>
                                <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                </svg>
                                Download
                            </a>
                        </div>
                        <div class="tab-panel" id="panel-content">
                            <!-- Content will be inserted by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- New Analysis -->
                <div class="new-analysis">
                    <button class="btn-secondary" onclick="resetToUpload()">
                        Analyze Another Document
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p>
                North Star provides orientation, not authority. This tool does not constitute legal advice, 
                clinical diagnosis, or professional recommendation. Output summaries are for preparation and 
                organization purposes only. Always consult qualified attorneys, guardians ad litem, or mental 
                health professionals for case-specific guidance.
            </p>
        </div>
    </footer>

    <script>
        // State
        let selectedFile = null;
        let outputs = {
            attorney: '',
            gal: '',
            internal: ''
        };
        let currentTab = 'attorney';

        // Elements
        const dropzone = document.getElementById('dropzone');
        const fileInput = document.getElementById('file-input');
        const fileSelected = document.getElementById('file-selected');
        const selectedFilename = document.getElementById('selected-filename');
        const analyzeBtn = document.getElementById('analyze-btn');
        const uploadArea = document.getElementById('upload-area');
        const processingArea = document.getElementById('processing-area');
        const resultsArea = document.getElementById('results-area');
        const errorMessage = document.getElementById('error-message');
        const tabTitle = document.getElementById('tab-title');
        const downloadBtn = document.getElementById('download-btn');
        const panelContent = document.getElementById('panel-content');

        // File input change handler
        fileInput.addEventListener('change', function(e) {
            if (e.target.files.length > 0) {
                handleFileSelect(e.target.files[0]);
            }
        });

        // Drag and drop handlers
        dropzone.addEventListener('dragover', function(e) {
            e.preventDefault();
            dropzone.classList.add('dragover');
        });

        dropzone.addEventListener('dragleave', function(e) {
            e.preventDefault();
            dropzone.classList.remove('dragover');
        });

        dropzone.addEventListener('drop', function(e) {
            e.preventDefault();
            dropzone.classList.remove('dragover');
            if (e.dataTransfer.files.length > 0) {
                handleFileSelect(e.dataTransfer.files[0]);
            }
        });

        // Click to upload
        dropzone.addEventListener('click', function(e) {
            if (e.target.tagName !== 'BUTTON') {
                fileInput.click();
            }
        });

        function handleFileSelect(file) {
            // Validate file type
            const ext = file.name.split('.').pop().toLowerCase();
            if (!['txt', 'md'].includes(ext)) {
                showError('Invalid file type. Please upload a .txt or .md file.');
                return;
            }

            // Validate file size (5MB)
            if (file.size > 5 * 1024 * 1024) {
                showError('File too large. Please upload a file under 5MB (~10 pages).');
                return;
            }

            selectedFile = file;
            selectedFilename.textContent = file.name;
            fileSelected.classList.remove('hidden');
            analyzeBtn.classList.remove('hidden');
            hideError();
        }

        function removeFile() {
            selectedFile = null;
            fileInput.value = '';
            fileSelected.classList.add('hidden');
            analyzeBtn.classList.add('hidden');
        }

        function showError(message) {
            document.querySelector('.error-text').textContent = message;
            errorMessage.classList.remove('hidden');
        }

        function hideError() {
            errorMessage.classList.add('hidden');
        }

        async function analyzeDocument() {
            if (!selectedFile) return;

            // Show processing
            uploadArea.classList.add('hidden');
            processingArea.classList.remove('hidden');
            hideError();

            // Create form data
            const formData = new FormData();
            formData.append('file', selectedFile);

            try {
                const response = await fetch('/upload', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (!response.ok || data.error) {
                    throw new Error(data.error || 'Analysis failed');
                }

                // Store outputs
                outputs = data.outputs;
                
                // Show results
                processingArea.classList.add('hidden');
                resultsArea.classList.remove('hidden');
                
                // Display first tab
                switchTab('attorney', document.querySelector('[data-tab="attorney"]'));

            } catch (error) {
                processingArea.classList.add('hidden');
                uploadArea.classList.remove('hidden');
                showError(error.message || 'Unable to process file. Please try again.');
            }
        }

        function switchTab(tabId, button) {
            currentTab = tabId;

            // Update active tab
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            button.classList.add('active');

            // Update title
            const titles = {
                attorney: 'Attorney Summary',
                gal: 'Guardian Ad Litem & Therapist Summary',
                internal: 'Internal Clarity'
            };
            tabTitle.textContent = titles[tabId];

            // Update download link
            const files = {
                attorney: 'attorney-summary.md',
                gal: 'gal-clinician-summary.md',
                internal: 'internal-clarity.md'
            };
            downloadBtn.href = '/download/' + files[tabId];

            // Update content
            panelContent.textContent = outputs[tabId] || 'No content available.';
        }

        function resetToUpload() {
            resultsArea.classList.add('hidden');
            uploadArea.classList.remove('hidden');
            removeFile();
            outputs = { attorney: '', gal: '', internal: '' };
        }
    </script>
</body>
</html>
